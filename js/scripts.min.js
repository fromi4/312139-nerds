var link=document.querySelector(".map-button"),popup=document.querySelector(".modal-letter"),form=popup.querySelector("form"),close=document.querySelector(".modal-close"),letterName=popup.querySelector("[name=name]"),letterEmail=popup.querySelector("[name=email]"),letterText=popup.querySelector("[name=freetext]"),storageNameSupport=!0,storageName="",storageEmailSupport=!0,storageEmail="";try{storageName=localStorage.getItem("letterName")}catch(e){storageNameSupport=!1}try{storageEmail=localStorage.getItem("letterEmail")}catch(e){storageEmailSupport=!1}link.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("modal-show"),storageName&&storageEmail?(letterName.value=storageName,letterEmail.value=storageEmail,letterText.focus()):letterName.focus()}),close.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("modal-show"),popup.classList.remove("modal-error")}),window.addEventListener("keydown",function(e){27===e.keyCode&&popup.classList.contains("modal-show")&&(e.preventDefault(),popup.classList.remove("modal-show"),popup.classList.remove("modal-error"))}),form.addEventListener("submit",function(e){letterName.value&&letterEmail.value&&letterText.value?(storageNameSupport&&localStorage.setItem("letterName",letterName.value),storageEmailSupport&&localStorage.setItem("letterEmail",letterEmail.value)):(e.preventDefault(),popup.classList.remove("modal-error"),popup.offsetWidth=popup.offsetWidth,popup.classList.add("modal-error"))});
